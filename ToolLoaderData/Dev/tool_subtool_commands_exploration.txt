
/* TEST AND EXPLAIN ZBRUSH COMMAND TOOL MADNESS, saving and renaming of subtools makes things "funny"

	MAIN SUBTOOL IS FIRST SUBTOOL NAMED AS .ztl FILE


	TLTR: IT SEEMS THAT, IF FIRST SUBTOOL IS RENAMED ONCE, IT IS NOT POSSIBLE TO GET .ztl FILE OF CURRENT TOOL


	CONNECTION BETWEEN .ztl FILE AND 1st SUBTOOL:
		WORKS IF: 1st subtool has same name as .ztl file and not been renamed after save

		BREAKS:
			1 ) 1st subtool was moved in list	( conncetion is repaired if subtool is moved back to 1st place )
			2 ) 1st subtool was renamed, then connection is lost even if tool is renamed back

*/
[IButton, TOOL_AND_SUBTOOL_INFO_DEBUG, "Loop subtools and compare command on different sates of tools and subtools",
[IConfig,2022]


[Loop, [SubToolGetCount],

	[SubToolSelect, i ]


	/*------------------------------------------------------------------------------

		FIND SUBTOOL MATCHING NAME OF .ztl FILE

	--------------------------------------------------------------------------------*/

	/* GET .ztl FILE PATH WORKS ONLY IF MAIN SUBTOOLS IS FIRST
	*/
	[VarSet, $path_by_tool_index, [FileNameExtract, [ToolGetPath, [IGet, Tool:ItemInfo]], 1 ] ]


	/* SERACH FOR MAIN SUBTOOL WORKS

	   Subtool which name match .ztl filename is MAIN SUBTOOL E.G.: fooTool.ztl == Subtool:fooTool

		HOW TO FIND MAIN SUBTOOL:
			MAIN SUBTOOL   returns path to .ztl file
			Other Subtools returns their name

		RESULT:
			IF PATH != SUBTOOL NAME

	*/
	[VarSet, $subtool_name, [FileNameExtract, [GetActiveToolPath], 2 ]]
	[VarSet, $subtool_path, [IGetTitle, Tool:Current Tool]]
	[VarSet, $IS_MAIN_TOOL, ! (([StrLength, $subtool_name]==[StrLength, $subtool_path]) && ([StrFind, $subtool_name, $subtool_path] > -1))]

	[VarSet, $find_main_tool,
		 [StrMerge,

		 	"$subtool_path: ", $subtool_path, "\n\n",
		 	"$subtool_name: ", $subtool_name, "\n\n",
		 	"$IS_MAIN_TOOL: ", $IS_MAIN_TOOL, "\n\n",


			"" // last item, prevents error with last comma on dev
		]
	]


	/*------------------------------------------------------------------------------

		LIST FUNCTIONS

	--------------------------------------------------------------------------------*/



	[VarSet, $command_fn,
		 [StrMerge,

			/* GET current tool path or name, depends on conditions:
				1) return PATH to current tool file, IF CONNECTION WORKS
				2) return NAME of 1st subtool        IF CONNECTION IS LOST

			*/
			"[ToolGetPath]: ",       [ToolGetPath], "\n\n",

			/* GET current subtool path or name, depends on conditions:
				1) return PATH to current subtool file, IF CONNECTION WORKS
				2) return NAME of current subtool        IF CONNECTION IS LOST
			*/
			"[GetActiveToolPath]: ", [GetActiveToolPath], "\n\n",


			/* GET current .ztl file path
				1) return PATH to current .ztl file, IF CONNECTION WORKS
				2) return ""                         IF CONNECTION IS LOST

			*/
			"FILE DIR: ",               [FileNameExtract, [ToolGetPath], 1 ], "\n\n",

			/* GET name of current subtool EVERY TIME - GREAT, AWESOME, UNBELIEVABLE !!!

			*/
			"SUBTOOL NAME: ",               [FileNameExtract, [GetActiveToolPath], 2 ], "\n\n"

			/* Current Tool Number
			*/
           "[ToolGetActiveIndex]:     ",[ToolGetActiveIndex],   "\n\n"
			"" // last item, prevents error with last comma on dev
		]
	]

	/* STRING REACH MAX FUCKING LENGTH ROLF :D WTF, use second */
	[VarSet, $commands_info,
		 [StrMerge,

			/*
			    GET path to current .ztl file if current subtool is MAIN SUBTOOL

				WORKS IF:   MAIN SUBTOOL is on any place in subtool list
				BREAKS IF:  MAIN SUBTOOL was renamed once, stay broken eveen if renamed back to origin name
			*/
		 	"[IGetTitle, Tool:Current Tool]: ", [IGetTitle,Tool:Current Tool], "\n\n",


			/* GET current tool\subtool name ( Selected subtool appears as tool )

				USELESS:  return name with trailing "." E.G.: "fuckin-subtool."

				USE THIS: [FileNameExtract, [GetActiveToolPath], 2 ]

			*/
			"[IGetTitle, Tool:ItemInfo]:     ", [IGetTitle,Tool:ItemInfo], "\n\n",


			/* Current Tool index - same as [ToolGetActiveIndex]
			*/
           "[IGet, Tool:ItemInfo]:     ",[IGet, Tool:ItemInfo],   "\n\n",


			//"" // last item, prevents error with last comma on dev
		]
	]


	/*------------------------------------------------------------------------------
		TEST INFO
	--------------------------------------------------------------------------------*/
	[Note, $command_fn,, 0]

	//[Note, $commands_info,, 0]


	/*------------------------------------------------------------------------------
		TEST FUNCTIONS
	--------------------------------------------------------------------------------*/

	//[Note, $find_main_tool,, 0]

	//[Note, $find_ztl_file,, 0] // WORKS UNTIL RENAME

	//[Note, $path_by_tool_index,, 0] // WORKS UNTIL RENAME



, i] // end loop


]/*End of ZScript*/
